http{
    server {
        listen 5000 ssl;

        server_name  longdqsys.io.vn;                   
        ssl_certificate /certs/tls.crt;           
        ssl_certificate_key /certs/tls.key;       
        root /usr/share/nginx/html;

        index index.html index.html;

        location / {
          set $cors 'true';
        
          if ($cors = 'true') {
            add_header 'Access-Control-Allow-Origin' "*" always;
            add_header 'Access-Control-Allow-Credentials' 'true' always;
            add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' '*' always;
            # required to be able to read Authorization header in frontend
            #add_header 'Access-Control-Expose-Headers' 'Authorization' always;
          }

          if ($request_method = 'OPTIONS') {
            
            add_header 'Access-Control-Max-Age' 1728000 always;
            add_header 'Content-Type' 'text/plain charset=UTF-8' always;
            add_header 'Content-Length' 0 always;
            return 204;
          }
        }

        location /route/v1 {
            proxy_set_header Content-Length "";
            proxy_set_header X-Original-URI $request_uri;
            proxy_pass http://127.0.0.1:7000/route/v1;
        }
    } 
}

events{
    worker_connections 1024;
}